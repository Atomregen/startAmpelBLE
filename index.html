<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriftAmpel Monitor</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>DriftAmpel Monitor</h1>
        
        <div class="section">
            <button id="btnConnect" class="connect-btn">Mit Ampel verbinden (BLE)</button>
            <div id="connectionStatus" class="status">Getrennt</div>
            <div id="timeSyncStatus" style="text-align:center; font-size:0.8em; color:#888; margin-top:5px;">Warte auf Sync...</div>
        </div>

        <div id="main-content" style="display:none;">
            <div class="section">
                <h3>Driftclub API Monitor</h3>
                <div class="form-row">
                    <label>Game ID(s):</label>
                    <div class="control">
                        <input id="myID" type="text" placeholder="z.B. g/GRUPPE/EVENT/1" value="">
                    </div>
                </div>
                <div class="form-row">
                    <button onclick="startDriftclubMonitor()">Überwachung starten</button>
                </div>
                
                <div class="status-box">
                    <div>Nächstes Rennen:</div>
                    <div id="nextRaceName" style="color:var(--primary-color); font-weight:bold;">-</div>
                    <div id="nextRaceTime" style="font-size:1.2em;">-</div>
                    <div id="nextRaceCountdown" style="color:var(--danger-color);">-</div>
                </div>

                <div class="schedule-container">
                    <details open>
                        <summary>Gefundene Sessions (Raw Data in Console)</summary>
                        <div id="schedule-list"><p>Keine Daten.</p></div>
                    </details>
                </div>
            </div>

            <div class="section">
                <h3>Manuelle Kontrolle</h3>
                <div class="button-group">
                    <button onclick="sendCommand('/cancel')" style="background:var(--danger-color)">ABBRUCH</button>
                    <button onclick="toggleYellowFlag()" id="btnYellow">Yellow Flag</button>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
